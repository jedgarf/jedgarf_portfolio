"use strict";function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,n,t){var o=_superPropBase(e,n);if(o)return o=Object.getOwnPropertyDescriptor(o,n),o.get?o.get.call(arguments.length<3?e:t):o.value}).apply(this,arguments)}function _superPropBase(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&_setPrototypeOf(e,n)}function _setPrototypeOf(e,n){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(e,n)}function _createSuper(t){var o=_isNativeReflectConstruct();return function(){var e,n=_getPrototypeOf(t);return _possibleConstructorReturn(this,o?(e=_getPrototypeOf(this).constructor,Reflect.construct(n,arguments,e)):n.apply(this,arguments))}}function _possibleConstructorReturn(e,n){if(n&&("object"===_typeof(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SplashEventStream=e()}(function(){return function o(i,s,r){function l(n,e){if(!s[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(a)return a(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}t=s[n]={exports:{}},i[n][0].call(t.exports,function(e){return l(i[n][1][e]||e)},t,t.exports,o,i,s,r)}return s[n].exports}for(var a="function"==typeof require&&require,e=0;e<r.length;e++)l(r[e]);return l}({1:[function(e,n,t){function o(e){return null==e}function i(e){for(var n,t=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(n=o[i];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""}function r(e){for(var n=arguments.length,t=new Array(1<n?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];if(!t.length)return e;var i=t.shift();if(l(e)&&l(i))for(var s in i)l(i[s])?(e[s]||Object.assign(e,_defineProperty({},s,{})),r(e[s],i[s])):Object.assign(e,_defineProperty({},s,i[s]));return r.apply(void 0,[e].concat(t))}var l=function(e){return e&&"object"===_typeof(e)&&!Array.isArray(e)};n.exports={generateNewGuidV4:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})},isValidGuid:function(e){return!0===new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$","i").test(e)},loadDynamicScriptFileAsync:function(i,s){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(null==s){if(null!=self)return self.importScripts(i),Promise.resolve();s=document}return new Promise(function(e,n){try{var t=s.createElement("script"),o=(t.src=i,t.onload=e,t.async=null==r||r,t.onerror=function(e){return n(e)},s.getElementsByTagName("script")[0]);o.parentNode.insertBefore(t,o)}catch(e){n(e)}})},setIntervalX:function(n,e,t){var o=0,i=window.setInterval(function(e){n(++o,e),o===t&&window.clearInterval(i)},e);return i},getCookieValue:i,finalizeConfigObjectToUseForInitIfCookiePresent:function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o={};return o=null==t?n():t,null!=document.cookie.match(e+"=([^;]+)")&&(n=JSON.parse(i(e)),o=r(o,n)),o},isNullOrUndefined:o,isBlankNullOrUndefined:function(e){return!(!o(e)&&""!=e)},isObjectBlankNullOrUndefined:function(e){return!!(o(e)||0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype)},isMobileNavigator:function(e){return!!(e&&e.navigator&&e.navigator.userAgent&&(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substring(0,4))))},mergeObjectsDeep:r}},{}],2:[function(e,n,t){var o={Default:"de",Mqtt:"mq",Ajax:"aj",All:"all"},i=_createClass(function e(){_classCallCheck(this,e),this.AjaxDetails={eventsPostEndpointUrl:"v1/clients/events",eventsSyncTimeInMillis:1e4,eventsBufferSize:10,maxSendRetries:2},this.MqttDetails={autoDownloadDependencies:!0,pahoMqttUrl:"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js",clientIdPrefix:"jsClientID-",mqttHost:"",mqttPort:9003,mqttUserName:"",mqttPassword:"",mqttIsSecureConnection:!0,onConnectFailCallback:null,onConnectSuccessCallback:null,defaultTopicToSend:"DefaultSplashClientEvents",connectionRetryConnectTime:2e3,connectionRetryCount:2},this.Commons={defaultClientToInitialize:o.Ajax,defaultClientToUse:o.Ajax,enableConsoleLogging:!1,enableErrorThrown:!1}});n.exports={Enums:{SendClientToUse:o},SplashConfig:i,getNewConfigurationObject:function(){var e=new i;return Object.seal(e),e}}},{}],3:[function(e,n,t){var o=e("./commonUtils"),i=e("./configModels"),e=_createClass(function e(){_classCallCheck(this,e),this.serverURL="",this.overrideTopicToBeUsed="",this.httpMethod="POST",this.headers={"Content-Type":"application/json"}}),s=_createClass(function e(){_classCallCheck(this,e),this.sendClientToUse=i.Enums.SendClientToUse.Default,this.forcePush=!1,this.overrideTopicToBeUsed="",this.qos=0}),r=function(){_inherits(e,s);_createSuper(e);function e(){return _classCallCheck(this,e),_possibleConstructorReturn(void 0)}return _createClass(e)}(),l=_createClass(function e(){_classCallCheck(this,e),this.topicToSubscribe="",this.callBackFunction=null}),a=function(){function n(e){_classCallCheck(this,n),this.IsClientSideValid=!1,this.ClientVersion="X.0.0.0",this.Id=o.generateNewGuidV4(),this.EventName="",this.EventType=e,this.OriginalTimeStamp=(new Date).toISOString(),this.SentAt="added automatically by package",this.ReceivedAt=null,this.Properties={},this.RetryCount=0}return _createClass(n,[{key:"validateProps",value:function(){this.IsClientSideValid=!1,this.Properties,this.IsClientSideValid=!0}}]),n}(),c=function(){_inherits(t,a);var n=_createSuper(t);function t(e){return _classCallCheck(this,t),(e=n.call(this,e)).Type="",e.UserUID=null,e.VisitorUID=null,e.VisitUID=null,e.PortalCD="",e.ProductCD="",e.Platform="",e.Locale="",e.Page="",e.RemoteIpAddress="",e.RemotePort="",e.Context={UserAgent:"",IsMobile:!1},e}return _createClass(t,[{key:"validateProps",value:function(){_get(_getPrototypeOf(t.prototype),"validateProps",this).call(this),this.IsClientSideValid&&(this.IsClientSideValid=!1,this.VisitorUID&&!o.isValidGuid(this.VisitorUID)||this.VisitUID&&!o.isValidGuid(this.VisitUID)||this.UserUID&&!o.isValidGuid(this.UserUID)||(this.IsClientSideValid=!0))}}]),t}();n.exports=(_defineProperty(n={Enums:{EventTypes:{AutoComplete:{AC_TTCSearched:"AC_TTCSearched",AC_TTCClicked:"AC_TTCClicked",AC_JobTitleSearched:"AC_JobTitleSearched",AC_JobTitleClicked:"AC_JobTitleClicked",toString:function(){return"AutoComplete"}},Dictionary:{DCT_SpellCheck:"DCT_SpellCheck",toString:function(){return"Dictionary"}},Custom:{CST_EnterBuilder:"CST_EnterBuilder",CST_DocDownloaded:"CST_DocDownloaded",CST_TemplateClick:"CST_TemplateClick",CST_TemplateDownload:"CST_TemplateDownload",toString:function(){return"Custom"}},Page:{PG_PageDetail:"PG_PageDetail",PG_ResourceMetrics:"PG_ResourceMetrics",PG_PerfMetrics:"PG_PerfMetrics",PG_InitialView:"PG_InitialView",PG_WebVitals:"PG_WebVitals",toString:function(){return"Page"}},Widget:{WDJ_Job:"WDJ_Job",WDJ_RR:"WDJ_RR",toString:function(){return"Widget"}},Component:{CMP_Builder:"CMP_Builder",toString:function(){return"Component"}},ClientExperiment:{EXP_CallToAction:"EXP_CallToAction",toString:function(){return"ClientExperiment"}},Debug:{DBG_Metrics:"DBG_Metrics",DBG_Data:"DBG_Data",toString:function(){return"Debug"}}},EventSubTypes:{wv_FCP:"wv_FCP",wv_LCP:"wv_LCP",wv_FID:"wv_FID",wv_CLS:"wv_CLS",PgViewEvAV_Blank:"PgViewEvAV_Blank",NewVisitor:"NewVisitor",ReturningVisitor:"ReturningVisitor",VisitorCallInitiated:"VisitorCallInitiated",VisitorCallNotInitiated:"VisitorCallNotInitiated",VisitorCallCompleted:"VisitorCallCompleted",CookiesWrittenSuccessfull:"CookiesWrittenSuccessfully"},EventActionTypes:{None:"None",Alias:"Alias",Track:"Track",Identify:"Identify"}},SendCustomAjaxEventProperties:e,SubscribeToTopicProperties:l,SendEventProperties:s,SendBulkEventProperties:r},"SendBulkEventProperties",r),_defineProperty(n,"BaseSplashEvent",a),_defineProperty(n,"getNewSplashEventObject",function(e,n){if("string"!=typeof n)throw new Error("passed parameter is not a string. ");var t=null,t=new c(n);return null!=e&&(null!=e.location&&(t.Page=e.location.href),null!=e.navigator&&(t.Context.UserAgent=e.navigator.userAgent,t.Locale=e.navigator.language),t.Context.IsMobile=o.isMobileNavigator(e)),Object.seal(t),t}),n)},{"./commonUtils":1,"./configModels":2}],4:[function(e,n,t){console&&console.log&&console.log("SES DW-"+Date.now()),window.TestLogDetailsMU=window.TestLogDetailsMU||{},TestLogDetailsMU.SESScriptDWTime=Date.now();function i(){return u}function o(){return{eventsToSendBuffer:f.ajaxClientToBeUsed.eventsToSendBuffer,eventsNotSentBuffer:f.ajaxClientToBeUsed.eventsNotSentBuffer}}var s=e("../commons/eventModels_ES6"),r=e("../commons/commonUtils"),l=e("../commons/configModels"),a=e("./splashMqttEventHandler"),c=e("./splashAjaxEventHandler"),u="J_3.0.0",f={splashConfig:null,mqttClientToBeUsed:null,ajaxClientToBeUsed:null,globalObject:null};f.splashConfig=l.getNewConfigurationObject(),f.splashConfig.Commons.enableErrorThrown=!0,f.splashConfig.Commons.enableConsoleLogging=!0;n.exports={initializeAsync:function(i){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=new Promise(function(e,n){if(TestLogDetailsMU.SESInitStartTime=Date.now(),i.SplashEventStream=i.SplashEventStream||{},f.globalObject=i,null!=s&&!s instanceof l.SplashConfig)throw new Error("SES Config not instance of 'SES Config' use getNewConfigurationObject()");if(f.splashConfig=r.finalizeConfigObjectToUseForInitIfCookiePresent("b_e_t_c",l.getNewConfigurationObject,s),f.splashConfig.Commons.enableConsoleLogging&&(console.log("SES Init Start-"+Date.now()),console.time&&console.time("SESInit")),s.Commons.defaultClientToInitialize==l.Enums.SendClientToUse.Default)throw new Error("SES Config.Commons.defaultClientToInitialize not set properly, set something other then default.");var t=[];if(s.Commons.defaultClientToInitialize==l.Enums.SendClientToUse.All||s.Commons.defaultClientToInitialize==l.Enums.SendClientToUse.Mqtt){var o=i.Paho||null;if(null==o&&0==s.MqttDetails.autoDownloadDependencies)throw new Error("Nither Paho found in Global Object nor autoDownloadDependencies is enabled");o=(null==o?r.loadDynamicScriptFileAsync(s.MqttDetails.pahoMqttUrl,f.globalObject.document):Promise.resolve()).then(function(){return a.mqttCreateClientObjectAndConnect(i,s)}).then(function(e){f.mqttClientToBeUsed=e});t.push(o)}if(s.Commons.defaultClientToInitialize==l.Enums.SendClientToUse.All||s.Commons.defaultClientToInitialize==l.Enums.SendClientToUse.Ajax){if(!i.fetch)throw new Error('Fetch Api Not Found in Global Scope, initialize different "defaultClientToInitialize". ');o=c.ajaxCreateClientObject(s).then(function(e){f.ajaxClientToBeUsed=e});t.push(o)}Promise.all(t).then(function(){TestLogDetailsMU.SESInitEndTime=Date.now(),console.log("SES Init Done-"+Date.now()),f.splashConfig.Commons.enableConsoleLogging&&console.timeEnd&&console.timeEnd("SESInit"),SplashEventStream.isInitDone=!0,e()}).catch(function(e){n(e)})});return e.catch(function(e){if(console.log("%c SES->InitializeSplashStreamObject Failed. Error is -  "+e.message,"background: Yellow;color:Red"),f.splashConfig.Commons.enableErrorThrown)throw e}),e},isInitDone:!1,subscribeToTopicAsync:function(t){var e=new Promise(function(e,n){if(f.splashConfig.Commons.enableConsoleLogging&&console.time&&console.time("SES SubsT_"+t.topicToSubscribe),null==t||null==t.topicToSubscribe)throw new Error("subscribeToTopicProperties is invalid or null.");if(null==f.mqttClientToBeUsed)throw new Error("MqttClient not initialized, cannot Subscribe Events.");a.mqttSubscribeToTopic(f.mqttClientToBeUsed,t).then(function(){f.splashConfig.Commons.enableConsoleLogging&&console.timeEnd&&console.timeEnd("SES SubsT_"+t.topicToSubscribe)})});return e.catch(function(e){if(console.log("%c SES->subscribeToTopicAsync Failed. Error is -  "+e.message,"background: Yellow;color:Red"),f.splashConfig.Commons.enableErrorThrown)throw e}),e},sendEventToServerAsync:function(t){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=new Promise(function(e,n){if(f.splashConfig.Commons.enableConsoleLogging&&t&&console.time&&console.time("SES SenEv_".concat(t.EventType,"_(").concat(t.Id,")")),null==o&&(o=new s.SendEventProperties),null==t||!t instanceof s.BaseSplashEvent)throw new Error("Event Object Not Initialized Properly Or type mismatch detected.");if(t.validateProps(),t.ClientVersion=i(),!o instanceof s.SendEventProperties)throw new Error("sendEventProperties Object Not Initialized Properly Or type mismatch detected.");if(o.sendClientToUse==l.Enums.SendClientToUse.Default&&(o.sendClientToUse=f.splashConfig.Commons.defaultClientToUse),o.sendClientToUse==l.Enums.SendClientToUse.All)throw new Error("sendEventProperties.sendClientToUse not set properly, set something other then All.");if(t.SentAt=(new Date).toISOString(),o.sendClientToUse==l.Enums.SendClientToUse.Ajax){if(null==f.ajaxClientToBeUsed)throw new Error("AjaxClient not initialized, cannot send Events.");c.ajaxSendEventToServer(f.ajaxClientToBeUsed,t,o).then(function(){e("Sent"),f.splashConfig.Commons.enableConsoleLogging&&t&&console.timeEnd&&console.timeEnd("SES SenEv_".concat(t.EventType,"_(").concat(t.Id,")"))}).catch(function(e){n(e)})}else if(o.sendClientToUse==l.Enums.SendClientToUse.Mqtt){if(null==f.mqttClientToBeUsed)throw new Error("MqttClient not initialized, cannot send Events.");a.mqttSendEventToServer(f.globalObject,f.mqttClientToBeUsed,t,o).then(function(){e("Sent"),f.splashConfig.Commons.enableConsoleLogging&&t&&console.timeEnd&&console.timeEnd("SES SenEv_".concat(t.EventType,"_(").concat(t.Id,")"))}).catch(function(e){n(e)})}else n(new Error("sendEventProperties.sendClientToUse is not registered with framework."))});return e.catch(function(e){if(console.log("%c SES->sendEventToServer Failed. Error is -  "+e.message,"background: Yellow;color:Red"),f.splashConfig.Commons.enableErrorThrown)throw e}),e},sendCustomAjaxEventToServerAsync:function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=new Promise(function(n,t){if(null==o){if(""==f.splashConfig.AjaxDetails.eventsPostEndpointUrl)throw new Error("Incomplete details, initialize Ajax Client or pass url in properties.");(o=new s.SendCustomAjaxEventProperties).serverURL=f.splashConfig.AjaxDetails.eventsPostEndpointUrl}if(""==o.serverURL)throw new Error("sendCustomAjaxEventProperties.serverURL is set to blank.");if(null==e||!e instanceof s.BaseSplashEvent)throw new Error("Event Object Not Initialized Properly Or type mismatch detected.");if(e.validateProps(),e.ClientVersion=i(),!o instanceof s.SendCustomAjaxEventProperties)throw new Error("sendCustomAjaxEventProperties Object Not Initialized Properly Or type mismatch detected.");e.SentAt=(new Date).toISOString(),c.ajaxSendCustomEventToServer(e,o,f.splashConfig.Commons.enableConsoleLogging).then(function(e){n(e)}).catch(function(e){t(e)})});return n.catch(function(e){if(console.log("%c SES->sendCustomAjaxEventToServerAsync Failed. Error is -  "+e.message,"background: Yellow;color:Red"),f.splashConfig.Commons.enableErrorThrown)throw e}),n},getEventBuffer:o,clearEventBuffer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";return"all"!=e&&"eventsToSendBuffer"!=e||(f.ajaxClientToBeUsed.eventsToSendBuffer=[]),"all"!=e&&"eventsNotSentBuffer"!=e||(f.ajaxClientToBeUsed.eventsNotSentBuffer=[]),o()},ClassInitializers:{getNewConfigurationObject:l.getNewConfigurationObject,getNewSplashEventObject:function(e){return s.getNewSplashEventObject(f.globalObject,e)},SendEventProperties:s.SendEventProperties,SendBulkEventProperties:s.SendBulkEventProperties,SubscribeToTopicProperties:s.SubscribeToTopicProperties,SendCustomAjaxEventProperties:s.SendCustomAjaxEventProperties},Enums:{EventTypes:s.Enums.EventTypes,EventSubTypes:s.Enums.EventSubTypes,EventActionTypes:s.Enums.EventActionTypes,SendClientToUse:l.Enums.SendClientToUse},Utils:{mergeObjectsDeep:r.mergeObjectsDeep},getVersion:i}},{"../commons/commonUtils":1,"../commons/configModels":2,"../commons/eventModels_ES6":3,"./splashAjaxEventHandler":5,"./splashMqttEventHandler":6}],5:[function(e,n,t){function s(s){return new Promise(function(n,t){null!=s.eventsToSendBuffer&&0!=s.eventsToSendBuffer.length||n(r);var o=s.eventsToSendBuffer;s.eventsToSendBuffer=[];for(var e=0;e<o.length;e++)null!=o[e]&&(o[e].SentAt=(new Date).toISOString());var i="";s.splashConfig.Commons.enableConsoleLogging?(i=JSON.stringify(o),console.log("Ajax to server - Started-"+Date.now())):i=JSON.stringify(o,function(e,n){return null!=n&&""!==n?n:void 0}),l(s.splashConfig.AjaxDetails.eventsPostEndpointUrl,i).then(function(e){s.splashConfig.Commons.enableConsoleLogging&&console.log("Ajax to server - Finished. Code:(".concat(e.status,")-").concat(Date.now())),e.ok?n(e):(a(s,o),t(new Error("Ajax to server - Failed. Code:(".concat(e.status,")-").concat(Date.now()))))}).catch(function(e){s.splashConfig.Commons.enableConsoleLogging&&(console.log("Ajax to server - Failed-"+Date.now()),console.log(e)),a(s,o),t(e)})})}var r={json:function(){return{type:"custom",status:"success"}}},l=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return fetch(e,{method:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"POST",credentials:"omit",headers:3<arguments.length&&void 0!==arguments[3]?arguments[3]:{"Content-Type":"application/json"},body:n})},a=function(n,e){var t=[];null!=e&&e.forEach(function(e){e.RetryCount<n.splashConfig.AjaxDetails.maxSendRetries?(n.splashConfig.Commons.enableConsoleLogging&&console.log("Marked For Retry: Count: '".concat(e.RetryCount,"' - Event: '").concat(e.Id,"'-")+Date.now()),e.RetryCount+=1,t.push(e)):(n.splashConfig.Commons.enableConsoleLogging&&console.log("Rerty Over: Count: '".concat(e.RetryCount,"' - Event: '").concat(e.Id,"'-")+Date.now()),n.eventsNotSentBuffer.push(e))}),n.eventsToSendBuffer=t.concat(n.eventsToSendBuffer)};n.exports={ajaxCreateClientObject:function(e){e.Commons.enableConsoleLogging&&console.log("AjaxClient Init Started-"+Date.now());var n={splashConfig:e,eventsToSendBuffer:[],eventsNotSentBuffer:[],syncIntervalObject:-1,ajaxCreateConnectionAndSendEvents:s};return 0<e.AjaxDetails.eventsSyncTimeInMillis&&(n.syncIntervalObject=setInterval(function(){null!=n.eventsToSendBuffer&&0<n.eventsToSendBuffer.length&&(n.splashConfig.Commons.enableConsoleLogging&&console.log("Time Interval Reached-"+Date.now()),n.ajaxCreateConnectionAndSendEvents(n).catch(function(e){console.log("%c SplashEventStream->SyncIntervalFunction Failed. Error is -  "+e.message,"background: Yellow;color:Red")}))},e.AjaxDetails.eventsSyncTimeInMillis)),e.Commons.enableConsoleLogging&&console.log("AjaxClient Init Success-"+Date.now()),Promise.resolve(n)},ajaxSendEventToServer:function(t,o,i){return new Promise(function(e,n){t.splashConfig.Commons.enableConsoleLogging&&console.log("Event Added To Queue (".concat(o.EventType,") -")+Date.now()),i.forcePush||0==t.splashConfig.AjaxDetails.eventsSyncTimeInMillis||t.eventsToSendBuffer.length+1>=t.splashConfig.AjaxDetails.eventsBufferSize?(t.splashConfig.Commons.enableConsoleLogging&&console.log("Event Send Started-"+Date.now()),t.eventsToSendBuffer.push(o),s(t).then(function(){e("")}).catch(function(e){n(e)})):(t.eventsToSendBuffer.push(o),e(""))})},ajaxSendEventToServerInBulk:function(e,n,t){},ajaxSendCustomEventToServer:function(o,i,s){return new Promise(function(n,t){var e="",e=s?JSON.stringify([o]):JSON.stringify([o],function(e,n){return null!=n&&""!==n?n:void 0});l(i.serverURL,e,i.httpMethod,i.headers).then(function(e){s&&console.log("Ajax Custom - Finished. Code:(".concat(e.status,")-").concat(Date.now())),n(e)}).catch(function(e){s&&console.log("Ajax Custom - Failed-"+Date.now()),t(e)})})}}},{}],6:[function(e,n,t){function l(t,o,i,s){return new Promise(function(e,n){Promise.resolve().then(function(){var e;if(!o.pahoClient.isConnected())return(e=r(o)).then(function(){}),e}).then(function(){var e=s.overrideTopicToBeUsed||i.EventType||o.splashConfig.MqttDetails.defaultTopicToSend,n=(o.splashConfig.Commons.enableConsoleLogging&&console.log("Sending Message To Topic- "+e+"-"+Date.now()),i.SentAt=(new Date).toISOString(),JSON.stringify(i)),n=new t.Paho.MQTT.Message(n);n.destinationName=e,o.pahoClient.send(n),o.splashConfig.Commons.enableConsoleLogging&&console.log("Message Sent To Topic- "+e+"-"+Date.now())}).then(function(){e()}).catch(function(e){n(e)})})}function i(e,n,t){e.splashConfig.Commons.enableConsoleLogging&&console.log("New Message Received on Topic - "+n.destinationName+"-"+Date.now()),t&&"function"==typeof t&&t(n)}function r(o){return new Promise(function(e,n){try{o.splashConfig.Commons.enableConsoleLogging&&console.log("Connecting to "+o.splashConfig.MqttDetails.mqttHost+":"+o.splashConfig.MqttDetails.mqttPort+" ClientId- "+o.pahoClientId+"-"+Date.now());var t={onSuccess:function(){s(o,e)},onFailure:function(e){a(o,new Error(e.errorMessage),n)},userName:o.splashConfig.MqttDetails.mqttUserName,password:o.splashConfig.MqttDetails.mqttPassword,useSSL:o.splashConfig.MqttDetails.mqttIsSecureConnection};o.pahoClient.connect(t)}catch(e){t=null,t=e instanceof Error?e:e&&e instanceof Object&&e.errorMessage?new Error(e.errorMessage):new Error("Error occoured while connecting to server - "+e);a(o,t,n)}})}var s=function(e,n){e.splashConfig.Commons.enableConsoleLogging&&console.log("Connection to "+e.splashConfig.MqttDetails.mqttHost+":"+e.splashConfig.MqttDetails.mqttPort+" is Successful-"+Date.now()),e.splashConfig.MqttDetails.onConnectSuccessCallback&&"function"==typeof e.splashConfig.MqttDetails.onConnectSuccessCallback&&e.splashConfig.MqttDetails.onConnectSuccessCallback(),n()},a=function(e,n,t){e.splashConfig.Commons.enableConsoleLogging&&console.log("Connection to "+e.splashConfig.MqttDetails.mqttHost+":"+e.splashConfig.MqttDetails.mqttPort+" failed, with message - '"+n.message+"'-"+Date.now()),e.splashConfig.MqttDetails.onConnectFailCallback&&"function"==typeof e.splashConfig.MqttDetails.onConnectFailCallback&&e.splashConfig.MqttDetails.onConnectFailCallback(n),t(n)};n.exports={mqttCreateClientObjectAndConnect:function(o,i){return new Promise(function(e,n){var t={splashConfig:i,pahoClient:null,pahoClientId:""};i.Commons.enableConsoleLogging&&console.log("MqttClient Init Started-"+Date.now()),t.pahoClientId=i.MqttDetails.clientIdPrefix+parseInt(100*Math.random()),t.pahoClient=new o.Paho.MQTT.Client(i.MqttDetails.mqttHost,i.MqttDetails.mqttPort,t.pahoClientId),r(t).then(function(){i.Commons.enableConsoleLogging&&console.log("MqttClient Init Success-"+Date.now()),e(t)}).catch(function(e){i.Commons.enableConsoleLogging&&console.log("MqttClient Init Failed-"+Date.now()),n(e)})})},mqttSendEventToServer:l,mqttSendEventToServerInBulk:function(i,s,r){return new Promise(function(e,n){if(null!=s&&!Array.isArray(s))throw new Error("Event Array Not Initialized Properly.");for(var t=[],o=0;o<s.length;o++)t.push(l(i,s[o]),r);Promise.all(t).then(function(){e()}).catch(function(e){n(e)})})},mqttSubscribeToTopic:function(t,o){return new Promise(function(e,n){t.pahoClient.onMessageArrived=function(e){i(t,e,o.callBackFunction)},t.pahoClient.subscribe(o.topicToSubscribe),t.splashConfig.Commons.enableConsoleLogging&&console.log("Subscribed to Topic- "+o.topicToSubscribe+"-"+Date.now()),e()})}}},{}]},{},[4])(4)});